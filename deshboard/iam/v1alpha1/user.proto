syntax = "proto3";

package deshboard.iam.v1alpha1;

option go_package = "iam";

message AuthenticationRequest {
    string user_key = 1;
    string password = 2;
}

message AuthenticationResponse {
    bool success = 1;
}

// User Directory serves as an identity provider for users
service UserDirectory {
    rpc Authenticate (AuthenticationRequest) returns (AuthenticationResponse);
}

message NewUser {
    string username = 1;
    string email = 2;
    string password = 3;
}

message UserCreated {
    int64 id = 1;
}

message GetUser {
    oneof user_key {
        int64 id = 1;
        string username = 2;
        string email = 3;
    }
}

message User {
    int64 id = 1;
    string username = 2;
    string email = 3;
    string encrypted_password = 4;
}

// User Repository provides write access to User Directories
service UserRepository {
    rpc Create (NewUser) returns (UserCreated);

    rpc Get (GetUser) returns (User);
}
